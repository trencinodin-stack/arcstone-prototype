<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Arcstone — Interactive MVP Prototype</title>
<style>
  :root{
    --bg:#080708; --panel:#0f0f10; --muted:#bfc0c6; --accent:#2b9bf0;
    --glass: rgba(255,255,255,0.04);
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:#fff;}
  .app{display:flex;flex-direction:column;height:100vh;padding:20px;gap:16px;}
  .header{display:flex;align-items:center;justify-content:space-between;}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,rgba(43,155,240,0.24), rgba(43,155,240,0.12));display:flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.06);box-shadow:0 6px 20px rgba(43,155,240,0.08) inset;}
  .logo .dot{width:18px;height:18px;border-radius:4px;background:rgba(43,155,240,0.9)}
  .title{font-weight:700;font-size:18px}
  .subtitle{font-size:12px;color:var(--muted);margin-top:2px}
  .main{display:flex;flex:1;gap:18px;align-items:stretch}
  .sidebar{width:260px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.02));border-radius:14px;padding:16px;border:1px solid rgba(255,255,255,0.04);display:flex;flex-direction:column;gap:12px}
  .section-title{font-size:13px;font-weight:600}
  .app-btn{padding:10px;border-radius:12px;text-align:left;border:none;background:transparent;color:inherit;font-size:14px;cursor:pointer;display:block;width:100%}
  .app-btn.active{background:rgba(255,255,255,0.03);box-shadow:0 2px 10px rgba(0,0,0,0.4) inset}
  .status{margin-top:auto;font-size:13px;color:var(--muted)}
  .panel{flex:1;background:var(--panel);border-radius:14px;padding:14px;border:1px solid rgba(255,255,255,0.04);display:flex;flex-direction:column;overflow:hidden}
  .panel-header{display:flex;align-items:center;justify-content:space-between;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,0.02)}
  .content{display:flex;flex:1;gap:12px;overflow:hidden;padding-top:12px}
  .chat-col{flex:1;display:flex;flex-direction:column;height:100%}
  .messages{flex:1;overflow:auto;padding:10px;display:flex;flex-direction:column;gap:8px}
  .msg{max-width:70%;padding:10px;border-radius:12px;white-space:pre-wrap}
  .msg.user{background:linear-gradient(180deg,rgba(43,155,240,0.12),rgba(43,155,240,0.08));align-self:flex-end}
  .msg.assistant{background:rgba(255,255,255,0.02);align-self:flex-start}
  .composer{display:flex;gap:8px;padding:10px;border-top:1px solid rgba(255,255,255,0.02)}
  .input{flex:1;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02);color:#fff}
  .send{background:var(--accent);border:none;padding:10px 14px;border-radius:10px;color:#fff;font-weight:600;cursor:pointer}
  .right-col{width:300px;background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.02));padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column}
  .quick{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
  .small-btn{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--muted);cursor:pointer;text-align:left}
  .micro-app{height:100%;overflow:auto;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);padding:8px;border-radius:10px}
  .card{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);margin-bottom:8px}
  .task{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)}
  .muted{color:var(--muted);font-size:13px}
  footer{font-size:12px;color:var(--muted);text-align:center;padding:6px}
  @media (max-width:960px){ .sidebar{display:none} .right-col{display:none} }
</style>
</head>
<body>
<div class="app" id="app">
  <header class="header">
    <div class="brand">
      <div class="logo"><div class="dot"></div></div>
      <div>
        <div class="title">Arcstone</div>
        <div class="subtitle">MVP — interactive prototype</div>
      </div>
    </div>
    <div class="muted">Welcome, JT</div>
  </header>

  <main class="main">
    <aside class="sidebar">
      <div class="section-title">Micro-Apps</div>
      <button class="app-btn active" data-app="chat">Chat</button>
      <button class="app-btn" data-app="planner">Planner</button>
      <button class="app-btn" data-app="habits">Habits</button>
      <button class="app-btn" data-app="learning">Learning</button>
      <button class="app-btn" data-app="memory">Memory Search</button>
      <div class="status">Status: <span style="color:#6ee7b7">online</span></div>
    </aside>

    <section class="panel">
      <div class="panel-header">
        <div>
          <div style="font-weight:700">Arcstone — <span id="activeName">Chat</span></div>
          <div class="muted" id="memCount">Memory: 0 items</div>
        </div>
        <div class="muted">Prototype</div>
      </div>
      <div class="content">
        <div class="chat-col">
          <div class="messages" id="messages" aria-live="polite"></div>

          <div class="composer" role="region" aria-label="Message composer">
            <input id="input" class="input" placeholder="Message Arcstone..." />
            <button id="send" class="send">Send</button>
          </div>
        </div>

        <aside class="right-col">
          <div class="quick">
            <div class="muted">Quick Actions</div>
            <button class="small-btn" id="action-plan">Show today's plan</button>
            <button class="small-btn" id="action-sprint">Start a 25-minute focus sprint</button>
            <button class="small-btn" id="action-save">Save quick memory</button>
          </div>

          <div class="muted" style="margin-bottom:8px">Recent Memories</div>
          <div id="recentMem" class="micro-app"></div>
        </aside>
      </div>
    </section>
  </main>

  <footer>Interactive prototype — exportable HTML. Local-only; stores data in your browser.</footer>
</div>

<script>
(function(){
  // simple local "memory" and messages
  const messagesEl = document.getElementById('messages');
  const inputEl = document.getElementById('input');
  const sendBtn = document.getElementById('send');
  const memCountEl = document.getElementById('memCount');
  const recentMemEl = document.getElementById('recentMem');
  const activeName = document.getElementById('activeName');

  let messages = JSON.parse(localStorage.getItem('arc_messages')||'[]');
  let memory = JSON.parse(localStorage.getItem('arc_memory')||'[]');
  let active = localStorage.getItem('arc_active')||'chat';

  function renderMessages(){
    messagesEl.innerHTML = '';
    if(messages.length===0){
      messages = [{id:1,role:'assistant',text:'Arcstone front-end loaded. Say hi.'}];
    }
    messages.forEach(m=>{
      const el = document.createElement('div');
      el.className = 'msg ' + (m.role==='user' ? 'user' : 'assistant');
      el.textContent = m.text;
      messagesEl.appendChild(el);
    });
    messagesEl.scrollTop = messagesEl.scrollHeight;
    localStorage.setItem('arc_messages', JSON.stringify(messages));
  }

  function renderMemory(){
    memCountEl.textContent = 'Memory: ' + memory.length + ' items';
    recentMemEl.innerHTML = '';
    (memory.slice(0,6)).forEach(m=>{
      const card = document.createElement('div');
      card.className = 'card';
      const when = document.createElement('div'); when.className='muted'; when.textContent = new Date(m.when).toLocaleString();
      const text = document.createElement('div'); text.style.marginTop='6px'; text.textContent = m.text;
      card.appendChild(when); card.appendChild(text); recentMemEl.appendChild(card);
    });
    localStorage.setItem('arc_memory', JSON.stringify(memory));
  }

  function addMessage(role, text){
    messages.push({id:Date.now(), role, text});
    renderMessages();
  }

  function saveMemory(text){
    memory.unshift({id:Date.now(),text,when:new Date().toISOString()});
    if(memory.length>200) memory = memory.slice(0,200);
    renderMemory();
  }

  function generateResponse(input){
    const lower = (input||'').toLowerCase();
    if(lower.includes('plan') || lower.includes('today')){
      return "Here's a concise plan for today:\\n1) Finish the MVP front-end\\n2) Sync with engineering\\n3) Ship a demo flow";
    }
    if(lower.includes('learn') || lower.includes('teach') || lower.includes('learning')){
      return "Start a focused learning sprint: 25-minute block, 1 micro-lesson, 1 practice task. Want to begin?";
    }
    if(lower.includes('remember') || lower.includes('memory')){
      return "I found " + memory.length + " memories. Try the Memory Search micro-app for an interactive recall.";
    }
    return "Nice — tell me more. Or click a micro-app to get started.";
  }

  sendBtn.addEventListener('click',()=>{
    const text = inputEl.value.trim();
    if(!text) return;
    addMessage('user', text);
    saveMemory(text);
    inputEl.value = '';
    // simulate assistant
    setTimeout(()=>{
      const resp = generateResponse(text);
      addMessage('assistant', resp);
    }, 700 + Math.random()*600);
  });

  inputEl.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ sendBtn.click(); }});

  // sidebar app switching
  document.querySelectorAll('.app-btn').forEach(b=>{
    b.addEventListener('click', ()=>{
      document.querySelectorAll('.app-btn').forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      active = b.getAttribute('data-app');
      localStorage.setItem('arc_active', active);
      activeName.textContent = active.charAt(0).toUpperCase()+active.slice(1);
      // load micro-app panes
      loadApp(active);
    })
  });

  // quick actions
  document.getElementById('action-plan').addEventListener('click', ()=>{
    inputEl.value = "Show me today's plan";
    sendBtn.click();
  });
  document.getElementById('action-sprint').addEventListener('click', ()=>{
    inputEl.value = "Start a 25-minute focus sprint";
    sendBtn.click();
  });
  document.getElementById('action-save').addEventListener('click', ()=>{
    saveMemory('User triggered a quick insight at ' + new Date().toLocaleString());
  });

  // micro-app content loader
  function loadApp(name){
    const chatCol = document.querySelector('.chat-col');
    const micro = document.createElement('div');
    micro.className = 'micro-app';
    // replace current micro-app area (we'll clear messages area visually and add micro-app content)
    chatCol.querySelectorAll('.micro-app').forEach(n=>n.remove());
    if(name === 'chat'){
      // restore messages and composer (they already exist)
      chatCol.querySelectorAll('.messages,.composer').forEach(el=>el.style.display='block');
    } else {
      // hide messages and composer
      chatCol.querySelectorAll('.messages,.composer').forEach(el=>el.style.display='none');
      if(name === 'planner'){
        micro.innerHTML = '<div style="padding:8px"><div style="font-weight:700;margin-bottom:8px">Planner</div><div id="plannerList"></div><div style="margin-top:8px"><input id="taskInput" placeholder=\"Add task...\" style=\"width:70%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)\" /><button id="addTaskBtn" style="padding:8px;margin-left:8px;border-radius:8px;background:var(--accent);border:none;color:#fff">Add</button></div></div>';
        chatCol.appendChild(micro);
        // populate planner
        const tasks = JSON.parse(localStorage.getItem('arc_tasks')||'[]');
        const list = micro.querySelector('#plannerList');
        function renderTasks(){
          list.innerHTML = '';
          (tasks || []).forEach(t=>{
            const el = document.createElement('div');
            el.className = 'task';
            el.innerHTML = '<div>' + (t.done ? '✅ ' : '') + t.text + '</div><div><button class="small-btn" data-id="'+t.id+'">Toggle</button></div>';
            list.appendChild(el);
          });
        }
        renderTasks();
        micro.querySelector('#addTaskBtn').addEventListener('click', ()=>{
          const val = micro.querySelector('#taskInput').value.trim();
          if(!val) return;
          tasks.unshift({id:Date.now(),text:val,done:false});
          localStorage.setItem('arc_tasks', JSON.stringify(tasks));
          micro.querySelector('#taskInput').value='';
          renderTasks();
        });
        micro.addEventListener('click', (ev)=>{
          if(ev.target.matches('.small-btn')){
            const id = Number(ev.target.getAttribute('data-id'));
            const idx = tasks.findIndex(t=>t.id===id);
            if(idx>=0){ tasks[idx].done = !tasks[idx].done; localStorage.setItem('arc_tasks', JSON.stringify(tasks)); renderTasks(); }
          }
        });
      } else if(name === 'habits'){
        micro.innerHTML = '<div style="padding:8px"><div style="font-weight:700;margin-bottom:8px">Habits</div><div id="habitList"></div><div style="margin-top:8px"><input id="habitInput" placeholder=\"New habit...\" style="width:70%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)\" /><button id="addHabitBtn" style="padding:8px;margin-left:8px;border-radius:8px;background:var(--accent);border:none;color:#fff">Add</button></div></div>';
        chatCol.appendChild(micro);
        const habits = JSON.parse(localStorage.getItem('arc_habits')||'[]');
        const list = micro.querySelector('#habitList');
        function renderHabits(){
          list.innerHTML = '';
          (habits||[]).forEach(h=>{
            const el = document.createElement('div'); el.className='task'; el.innerHTML = '<div>'+h.text+'</div><div class="muted">Streak: '+(h.streak||0)+'</div>'; list.appendChild(el);
          });
        }
        renderHabits();
        micro.querySelector('#addHabitBtn').addEventListener('click', ()=>{
          const v = micro.querySelector('#habitInput').value.trim(); if(!v) return;
          habits.unshift({id:Date.now(),text:v,streak:0}); localStorage.setItem('arc_habits', JSON.stringify(habits)); micro.querySelector('#habitInput').value=''; renderHabits();
        });
      } else if(name === 'learning'){
        micro.innerHTML = '<div style="padding:8px"><div style="font-weight:700;margin-bottom:8px">Learning</div><div class="card"><div style="font-weight:600">Micro-Lesson: Focus Sprint</div><div class="muted" style="margin-top:6px">25 minute focus block. Start now?</div><div style="margin-top:8px"><button id="startLesson" class="small-btn">Start</button><button id="saveLesson" class="small-btn" style="margin-left:8px">Save</button></div></div></div>';
        chatCol.appendChild(micro);
        micro.querySelector('#startLesson').addEventListener('click', ()=>{
          addMessage('assistant','Starting 25-minute focus sprint. Timer notional (prototype).');
          loadApp('chat');
        });
        micro.querySelector('#saveLesson').addEventListener('click', ()=>{ saveMemory('Saved lesson: Focus Sprint'); loadApp('chat'); });
      } else if(name === 'memory'){
        micro.innerHTML = '<div style="padding:8px"><div style="font-weight:700;margin-bottom:8px">Memory Search</div><input id="memQuery" placeholder="Search memories..." style="width:100%;padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)" /><div id="memResults" style="margin-top:8px"></div></div>';
        chatCol.appendChild(micro);
        const qin = micro.querySelector('#memQuery'), res = micro.querySelector('#memResults');
        function doSearch(){ const q = (qin.value||'').toLowerCase().trim(); const results = q ? memory.filter(m=>m.text.toLowerCase().includes(q)) : memory; res.innerHTML=''; results.slice(0,30).forEach(r=>{ const el=document.createElement('div'); el.className='card'; el.innerHTML='<div class="muted">'+new Date(r.when).toLocaleString()+'</div><div style="margin-top:6px">'+r.text+'</div>'; res.appendChild(el); }); }
        qin.addEventListener('input', doSearch); doSearch();
      }
    }
  }

  // helper to add assistant message from micro-app actions
  function addMessage(role, text){
    messages.push({id:Date.now(),role,text});
    localStorage.setItem('arc_messages', JSON.stringify(messages));
    renderMessages();
  }
  // expose to micro-app scripts
  window.addMessage = addMessage;
  window.saveMemory = saveMemory;
  window.loadApp = loadApp;

  // initial render
  renderMessages();
  renderMemory();
  // set active tab based on stored value
  document.querySelectorAll('.app-btn').forEach(b=>{ if(b.getAttribute('data-app')===active) { b.classList.add('active'); activeName.textContent = active.charAt(0).toUpperCase()+active.slice(1); loadApp(active);} });
})();
</script>
</body>
</html>
